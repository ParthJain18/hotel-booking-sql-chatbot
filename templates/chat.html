{% extends "base.html" %}

{% block css %}
<link rel="stylesheet" href="{{ url_for('static', path='css/chat.css') }}">
{% endblock %}

{% block content %}
<div class="chat-container">
    <button class="toggle-sidebar" id="toggleSidebar">â‰¡</button>

    <!-- Sidebar with chat history -->
    <div class="chat-sidebar" id="chatSidebar">
        <div class="sidebar-header">
            <span>Chat History</span>
            <button class="new-chat-btn" id="newChatBtn">New Chat</button>
        </div>
        <div class="history-list" id="historyList">
            {% for history in histories %}
            <div class="history-item" data-id="{{ history.id }}">
                <div class="history-title">{{ history.title }}</div>
                <div class="history-date">{{ history.created_at }}</div>
            </div>
            {% endfor %}
        </div>
    </div>

    <!-- Main chat area -->
    <div class="chat-main">
        <div class="chat-page">
            <div class="chat-header">
                <h1>Chat with SQL</h1>
                <p class="chat-description">Ask questions about hotel booking data in natural language</p>
            </div>

            <div class="chat-interface">
                <div class="chat-messages" id="chatMessages">
                    <div class="message-container">
                        <div class="bot-message">
                            <div class="message-avatar">ðŸ¤–</div>
                            <div class="message-content">
                                <p>Hello! I'm your Hotel management assistant. Ask me questions about the hotel or
                                    booking data.</p>
                                <div class="message-examples">
                                    <p>Try asking:</p>
                                    <button class="example-btn"
                                        data-query="What other places can I visit near the hotel?">What other places can
                                        I visit near the hotel?</button>
                                    <button class="example-btn"
                                        data-query="Generate a pie chart to show the cancelled bookings vs total">Generate
                                        a pie chart to show the cancelled bookings vs total</button>
                                    <button class="example-btn"
                                        data-query="What's the average lead time for bookings?">What's the average lead
                                        time?</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="chat-input-container">
                    <div class="chat-input-wrapper">
                        <input type="text" id="userInput" placeholder="Type your question..." autocomplete="off">
                        <button id="sendButton">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                viewBox="0 0 16 16">
                                <path
                                    d="M15.964.686a.5.5 0 0 0-.65-.65L.767 5.855H.766l-.452.18a.5.5 0 0 0-.082.887l.41.26.001.002 4.995 3.178 3.178 4.995.002.002.26.41a.5.5 0 0 0 .886-.083l6-15Zm-1.833 1.89L6.637 10.07l-.215-.338a.5.5 0 0 0-.154-.154l-.338-.215 7.494-7.494 1.178-.471-.47 1.178Z" />
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', path='js/chat.js') }}"></script>
{% endblock %}